# 共享行程功能說明

## 功能概述

現在行程改為**共享模式**，所有用戶看到相同的行程，只有管理員可以編輯。這樣可以確保團隊成員都看到一致的行程安排。

## 功能特點

### 對於所有用戶：
- ✅ 可以查看完整的行程安排
- ✅ 看到所有檢查點和天數
- ✅ 行程會即時同步（當管理員更新時，所有用戶會自動看到最新版本）

### 對於管理員：
- ✅ 可以編輯任何檢查點的名稱
- ✅ 可以刪除檢查點
- ✅ 可以新增檢查點（每天都有「新增」按鈕）
- ✅ 編輯時會顯示「管理員模式」提示
- ✅ 所有變更會立即同步給所有用戶

## 設定步驟

### 1. 執行資料庫遷移

在 Supabase SQL Editor 中執行更新後的 `supabase/migration_add_trip_settings.sql`，這會：
- 創建 `shared_itinerary` 設定項
- 插入預設的行程檢查點

### 2. 初始化共享行程（如果需要）

如果資料庫中還沒有共享行程，系統會自動使用預設的行程：
- 第 1 天：武陵山莊 → 池有山 → 新達山屋
- 第 2 天：新達山屋 → 品田山 (V-Cliff) → 桃山山屋
- 第 3 天：桃山山屋 → 喀拉業山 → 武陵山莊

### 3. 管理員編輯行程

1. 以管理員身份登入
2. 前往「行程」頁面
3. 您會看到「管理員模式」提示
4. 可以：
   - 點擊鉛筆圖標編輯檢查點名稱
   - 點擊垃圾桶圖標刪除檢查點
   - 點擊每天的「新增」按鈕添加新檢查點

## 使用說明

### 編輯檢查點
1. 點擊檢查點旁邊的鉛筆圖標
2. 輸入新的名稱
3. 按 Enter 或點擊其他地方保存

### 新增檢查點
1. 在想要新增檢查點的那一天，點擊「新增」按鈕
2. 系統會自動添加一個名為「新檢查點」的項目
3. 點擊鉛筆圖標編輯名稱

### 刪除檢查點
1. 點擊檢查點旁邊的垃圾桶圖標
2. 檢查點會立即被刪除

## 注意事項

- **共享模式**：所有用戶看到相同的行程，這是團隊共享的行程
- **即時同步**：管理員的變更會立即同步給所有用戶
- **權限控制**：只有管理員可以編輯，普通用戶只能查看
- **資料存儲**：行程存儲在 `trip_settings` 表的 `shared_itinerary` 欄位中

## 技術細節

- 使用 `useSharedItinerary` hook 管理共享行程
- 行程數據以 JSON 格式存儲在 `trip_settings` 表中
- 使用 Supabase 的 real-time 功能實現即時同步
- RLS 政策確保只有管理員可以更新行程

