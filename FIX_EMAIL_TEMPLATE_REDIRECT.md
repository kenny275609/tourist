# ä¿®å¾© Email ç¢ºèªé€£çµé‡å®šå‘å•é¡Œ

## ğŸ” å•é¡Œåˆ†æ

æ‚¨çš„ Email ç¢ºèªé€£çµæ ¼å¼æ˜¯ï¼š
```
https://ahtwmunbgfzzawwweggo.supabase.co/auth/v1/verify?token=xxx&type=signup&redirect_to=https://tourist-lake-one.vercel.app/
```

é€™å€‹é€£çµæœƒï¼š
1. åœ¨ Supabase çš„é©—è­‰ç«¯é»è™•ç†é©—è­‰
2. ç›´æ¥é‡å®šå‘åˆ° `redirect_to` æŒ‡å®šçš„ URLï¼ˆé¦–é ï¼‰
3. **è·³éäº†æˆ‘å€‘çš„ `/auth/callback` è·¯ç”±**

å› æ­¤ï¼Œæˆ‘å€‘çš„ callback route ç„¡æ³•è™•ç†é©—è­‰ä¸¦è¨­ç½® `confirmed=true` åƒæ•¸ã€‚

## âœ… è§£æ±ºæ–¹æ¡ˆï¼šä¿®æ”¹ Supabase Email æ¨¡æ¿

### æ­¥é©Ÿ 1ï¼šå‰å¾€ Supabase Email æ¨¡æ¿è¨­å®š

1. ç™»å…¥ [Supabase Dashboard](https://supabase.com/dashboard)
2. é¸æ“‡æ‚¨çš„å°ˆæ¡ˆ
3. é»æ“Šå·¦å´é¸å–®çš„ **"Authentication"**
4. é»æ“Š **"Email Templates"**
5. æ‰¾åˆ° **"Confirm signup"** æ¨¡æ¿

### æ­¥é©Ÿ 2ï¼šä¿®æ”¹ç¢ºèªé€£çµ

åœ¨ Email æ¨¡æ¿ä¸­ï¼Œæ‰¾åˆ°ç¢ºèªé€£çµçš„éƒ¨åˆ†ã€‚é€šå¸¸æœƒæœ‰ä»¥ä¸‹å¹¾ç¨®æ ¼å¼ï¼š

#### é¸é … Aï¼šä½¿ç”¨è‡ªè¨‚ redirect_toï¼ˆæ¨è–¦ï¼‰

å¦‚æœæ¨¡æ¿ä¸­æœ‰ `{{ .ConfirmationURL }}`ï¼Œè«‹æ›¿æ›ç‚ºï¼š

```
{{ .SiteURL }}/auth/callback?token_hash={{ .TokenHash }}&type=email
```

æˆ–è€…ï¼Œå¦‚æœ Supabase æ”¯æ´è‡ªè¨‚ `redirect_to`ï¼Œä½¿ç”¨ï¼š

```
{{ .SiteURL }}/auth/callback?token_hash={{ .TokenHash }}&type=email&redirect_to={{ .SiteURL }}/
```

#### é¸é … Bï¼šä¿®æ”¹ç¾æœ‰çš„ redirect_to åƒæ•¸

å¦‚æœæ¨¡æ¿ä¸­å·²ç¶“æœ‰ `redirect_to` åƒæ•¸ï¼Œè«‹å°‡å®ƒæ”¹ç‚ºï¼š

```
{{ .SiteURL }}/auth/callback
```

### æ­¥é©Ÿ 3ï¼šå®Œæ•´çš„ Email æ¨¡æ¿ç¯„ä¾‹

ä»¥ä¸‹æ˜¯å»ºè­°çš„ "Confirm signup" æ¨¡æ¿å…§å®¹ï¼š

```html
<h2>ç¢ºèªæ‚¨çš„ Email</h2>

<p>æ„Ÿè¬æ‚¨è¨»å†Šï¼è«‹é»æ“Šä»¥ä¸‹é€£çµç¢ºèªæ‚¨çš„ Emailï¼š</p>

<p>
  <a href="{{ .SiteURL }}/auth/callback?token_hash={{ .TokenHash }}&type=email">
    ç¢ºèª Email
  </a>
</p>

<p>æˆ–è€…è¤‡è£½ä»¥ä¸‹é€£çµåˆ°ç€è¦½å™¨ï¼š</p>
<p>{{ .SiteURL }}/auth/callback?token_hash={{ .TokenHash }}&type=email</p>

<p>æ­¤é€£çµå°‡åœ¨ 24 å°æ™‚å¾ŒéæœŸã€‚</p>
```

### æ­¥é©Ÿ 4ï¼šä¿å­˜ä¸¦æ¸¬è©¦

1. é»æ“Š **"Save"** ä¿å­˜æ¨¡æ¿
2. è¨»å†Šä¸€å€‹æ–°å¸³è™Ÿï¼ˆæˆ–é‡æ–°ç™¼é€ç¢ºèª Emailï¼‰
3. æª¢æŸ¥æ–°çš„ Email ç¢ºèªé€£çµæ ¼å¼
4. é»æ“Šé€£çµï¼Œæ‡‰è©²æœƒï¼š
   - å…ˆè·³è½‰åˆ° `/auth/callback`
   - ç„¶å¾Œé‡å®šå‘åˆ°é¦–é ï¼Œå¸¶ä¸Š `?confirmed=true` åƒæ•¸
   - é¡¯ç¤ºæˆåŠŸé€šçŸ¥

## ğŸ”„ å‚™ç”¨æ–¹æ¡ˆ

å¦‚æœç„¡æ³•ä¿®æ”¹ Email æ¨¡æ¿ï¼Œæˆ‘å€‘å·²ç¶“å¯¦ç¾äº†å‚™ç”¨æ–¹æ¡ˆï¼š
- é¦–é æœƒæª¢æŸ¥ç”¨æˆ¶çš„ `email_confirmed_at` æ™‚é–“æˆ³
- å¦‚æœ Email åœ¨æœ€è¿‘ 30 ç§’å…§ç¢ºèªï¼Œæœƒè‡ªå‹•é¡¯ç¤ºé€šçŸ¥

ä½†é€™å€‹æ–¹æ¡ˆä¸å¦‚ä¿®æ”¹ Email æ¨¡æ¿å¯é ï¼Œå› ç‚ºï¼š
- å¦‚æœç”¨æˆ¶åœ¨ç¢ºèªå¾Œæ²’æœ‰ç«‹å³è¨ªå•é¦–é ï¼Œé€šçŸ¥å¯èƒ½ä¸æœƒé¡¯ç¤º
- æ™‚é–“çª—å£åªæœ‰ 30 ç§’

## ğŸ“ æ³¨æ„äº‹é …

- ä¿®æ”¹ Email æ¨¡æ¿å¾Œï¼Œ**æ–°çš„ç¢ºèª Email** æ‰æœƒä½¿ç”¨æ–°çš„é€£çµæ ¼å¼
- å·²ç¶“ç™¼é€çš„èˆŠ Email ä»ç„¶æœƒä½¿ç”¨èˆŠçš„é€£çµæ ¼å¼
- å»ºè­°åœ¨ä¿®æ”¹å¾Œæ¸¬è©¦æ–°è¨»å†Šçš„å¸³è™Ÿ

